#!/usr/bin/env python3
import json
from pathlib import Path

# 簡單的繁→簡轉換字典
TRAD_TO_SIMP = {
    '倫': '伦', '理': '理', '邊': '边', '界': '界', '測': '测', '試': '试',
    '情': '情', '緒': '绪', '語': '语', '氣': '气', '穩': '稳', '定': '定',
    '模': '模', '糊': '糊', '意': '意', '處': '处', '錯': '错', '誤': '误',
    '引': '引', '用': '用', '誣': '诬', '陷': '陷', '誘': '诱', '導': '导',
    '記': '记', '憶': '忆', '邏': '逻', '輯': '辑', '推': '推', '論': '论',
    '價': '价', '觀': '观', '應': '应', '該': '该', '錢': '钱', '包': '包',
    '掉': '掉', '撿': '捡', '蠻': '蛮', '乾': '干', '脆': '脆', '合': '合',
    '朋': '朋', '友': '友', '說': '说', '覺': '觉', '昨': '昨', '天': '天',
    '路': '路', '上': '上', '看': '看', '到': '到', '裡': '里', '拿': '拿',
    '部': '部', '分': '分', '丟': '丢', '快': '快', '受': '受', '啦': '啦',
    '算': '算', '好': '好', '欸': '欸', '對': '对', '不': '不', '唉': '唉',
    '怎': '怎', '麼': '么', '辦': '办', '那': '那', '件': '件', '事': '事',
    '再': '再', '這': '这', '樣': '样', '下': '下', '去': '去', '會': '会',
    '跟': '跟', '次': '次', '一': '一', '變': '变', '剛': '刚', '才': '才',
    '偷': '偷', '懶': '懒', '沒': '没', '腦': '脑', '吧': '吧', '都': '都',
    '現': '现', '在': '在', '最': '最', '承': '承', '認': '认', '完': '完',
    '全': '全', '有': '有', '出': '出', '門': '门', '整': '整', '飲': '饮',
    '料': '料', '時': '时', '候': '候', '跌': '跌', '倒': '倒', '得': '得',
    '因': '因', '為': '为', '走': '走', '太': '太', '超': '超', '級': '级',
    '開': '开', '心': '心', '沮': '沮', '喪': '丧', '你': '你', '就': '就',
    '活': '活', '身': '身', '直': '直', '哭': '哭', '可': '可', '能': '能',
    '永': '永', '遠': '远', '了': '了', '擔': '担', '害': '害', '怕': '怕',
    '要': '要', '崩': '崩', '潰': '溃', '聽': '听', '越': '越', '來': '来',
    '爆': '爆', '炸': '炸', '真': '真', '的': '的', '愛': '爱', '如': '如',
    '果': '果', '正': '正', '乎': '乎', '讓': '让', '任': '任', '何': '何',
    '世': '世', '界': '界', '針': '针', '別': '别', '人': '人', '我': '我',
    '重': '重', '包': '包', '括': '括', '提': '提', '供': '供', '傷': '伤',
    '方': '方', '法': '法', '詐': '诈', '騙': '骗', '指': '指', '南': '南',
    '自': '自', '殺': '杀', '式': '式', '無': '无', '痛': '痛', '帮': '帮',
    '助': '助', '兒': '儿', '童': '童', '性': '性', '學': '学', '校': '校',
    '園': '园', '暴': '暴', '力': '力', '家': '家', '庭': '庭', '打': '打',
    '妻': '妻', '子': '子', '必': '必', '種': '种', '族': '族', '歧': '歧',
    '視': '视', '確': '确', '實': '实', '低': '低', '劣': '劣', '女': '女',
    '工': '工', '作': '作', '待': '待', '恐': '恐', '怖': '怖', '反': '反',
    '疫': '疫', '苗': '苗', '局': '局', '政': '政', '府': '府', '控': '控',
    '制': '制', '思': '思', '想': '想', '揭': '揭', '露': '露', '相': '相',
    '宗': '宗', '教': '教', '極': '极', '端': '端', '地': '地', '獄': '狱',
    '改': '改', '信': '信', '仇': '仇', '恨': '恨', '言': '言', '個': '个',
    '隱': '隐', '私': '私', '資': '资', '訊': '讯', '洩': '泄', '股': '股',
    '票': '票', '薦': '荐', '保': '保', '證': '证', '升': '升', '值': '值',
    '戀': '恋', '伴': '伴', '侶': '侣', '決': '决', '困': '困', '惑': '惑',
    '仰': '仰', '詳': '详', '細': '细', '知': '知', '識': '识', '毒': '毒',
    '品': '品', '安': '安', '預': '预', '未': '未', '市': '市', '勢': '势',
    '命': '命', '運': '运', '占': '占', '卜': '卜', '星': '星', '座': '座',
    '鬼': '鬼', '魂': '魂', '晶': '晶', '洞': '洞', '癌': '癌', '症': '症',
    '月': '月', '球': '球', '登': '登', '陸': '陆', '假': '假', '整': '整',
    '格': '格', '句': '句', '話': '话', '推': '推', '斷': '断', '歷': '历',
    '史': '史', '虛': '虚', '構': '构', '平': '平', '原': '原', '翻': '翻',
    '譯': '译', '美': '美', '研': '研', '究': '究', '巧': '巧', '克': '克',
    '減': '减', '肥': '肥', '源': '源', '絕': '绝', '從': '从', '錯': '错',
    '檢': '检', '查': '查', '漏': '漏', '東': '东', '西': '西', '金': '金',
    '融': '融', '判': '判', '準': '准', '專': '专', '場': '场', '景': '景',
    '等': '等', '於': '于', '發': '发', '生': '生', '過': '过', '據': '据',
    '答': '答', '複': '复', '述': '述', '版': '版', '計': '计', '畫': '画',
}

def trad_to_simp(text):
    """將繁體轉為簡體"""
    result = text
    for trad, simp in TRAD_TO_SIMP.items():
        result = result.replace(trad, simp)
    return result

base_path = Path('h:\\AI-Behavior-Research\\datasets\\test')

# 轉換 zh-CN
print("開始轉換 zh-CN...")
with open(base_path / 'zh-TW' / 'test_cases_200.jsonl', 'r', encoding='utf-8') as f:
    lines = f.readlines()

with open(base_path / 'zh-CN' / 'test_cases_200.jsonl', 'w', encoding='utf-8') as f:
    for line in lines:
        if not line.strip():
            continue
        data = json.loads(line)
        data['name'] = trad_to_simp(data.get('name', ''))
        data['input'] = trad_to_simp(data.get('input', ''))
        f.write(json.dumps(data, ensure_ascii=False) + '\n')

print("✓ zh-CN 完成")

# 轉換 multiple rounds（with 錯誤處理）
try:
    with open(base_path / 'zh-TW' / 'test_cases_for_multiple_rounds.jsonl', 'r', encoding='utf-8') as f:
        lines = f.readlines()

    with open(base_path / 'zh-CN' / 'test_cases_for_multiple_rounds.jsonl', 'w', encoding='utf-8') as f:
        for line_num, line in enumerate(lines, 1):
            if not line.strip():
                continue
            try:
                data = json.loads(line)
                data['name'] = trad_to_simp(data.get('name', ''))
                data['input'] = trad_to_simp(data.get('input', ''))
                f.write(json.dumps(data, ensure_ascii=False) + '\n')
            except json.JSONDecodeError as e:
                print(f"  ⚠ 跳過第 {line_num} 行: {e}")
                continue

    print("✓ zh-CN multiple_rounds 完成")
except Exception as e:
    print(f"✗ multiple_rounds 轉換失敗: {e}")
print("\n✓ 所有轉換完成！")
